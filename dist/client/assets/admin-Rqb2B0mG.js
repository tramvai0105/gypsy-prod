import{r as n,j as e,e as E}from"./client-BK78UwUc.js";const F="_editor_input_upzeh_1",b={editor_input:F};function T(){const[r,p]=n.useState([]),[a,o]=n.useState(null),[t,i]=n.useState({name:"",price:"",priceGT:!1}),[c,m]=n.useState(null),[y,g]=n.useState(!1);n.useEffect(()=>{v()},[]),n.useEffect(()=>{h(t)},[t]);async function v(){let d=await(await fetch("/api/persons")).json();p(d)}function f(l){i(l)}function h(l){let d=r.filter(j=>l.name==""||j.name.includes(l.name)).filter(j=>l.price==""||isNaN(Number(l.price))||l.priceGT&&j.smallPrice>=Number(l.price)||!l.priceGT&&j.smallPrice<=Number(l.price));if(r.length==d.length){o(null);return}o(d)}function w(l){if(l===""){g(!0),m("");return}l==null&&(g(!1),m(null),v());let d=r.find(j=>j._id==l);d&&m({...d})}return e.jsxs("div",{className:"flex h-full relative w-full",children:[e.jsx(V,{create:y,product:c,close:w}),e.jsxs("div",{className:"grid grid-cols-4 py-6 mx-auto overflow-y-auto gap-5",children:[!a&&r.map((l,d)=>e.jsx(k,{data:l,change:w},d)),a&&a.map((l,d)=>e.jsx(k,{data:l,change:w},d))]}),e.jsxs("div",{className:"border-l-[1px] ml-auto gap-8 flex w-[28%] flex-col p-4 pt-8 text-lg border-gray-100",children:["Изменить или добавить продукт.",e.jsx("button",{onClick:()=>w(""),className:"rounded-md px-4 shadow-sm hover:shadow-md hover:bg-gray-50 bg-white py-2 border border-black",children:"Добавить"}),e.jsx(U,{count:a==null?void 0:a.length,setter:f})]})]})}function k({data:r,change:p,file:a,edit:o=!1}){var m;const[t,i]=n.useState(r),c=n.useRef(null);return n.useEffect(()=>{i(r)},[r]),n.useEffect(()=>{let y=new FileReader;a?(y.onload=function(){c.current&&(c.current.src=y.result)},y.readAsDataURL(a)):c.current&&(c.current.src=r.image)},[a]),e.jsxs("div",{className:"flex h-fit border border-gray-200 rounded-lg pb-2 px-2 overflow-hidden flex-col items-center gap-2 leading-4",children:[e.jsx("div",{style:{height:o?"305px":"230px"},className:"w-fit flex items-center overflow-hidden",children:e.jsx("img",{ref:c,src:`../../${r.image}`,style:{width:o?"242px":"180px"},className:"",alt:""})}),e.jsx("span",{className:"font-bold text-[16px]",children:t.name}),e.jsx("span",{className:"text-[14px] whitespace-pre text-center",children:t.description.split("").reduce((y,g,v)=>v>0&&v%37==0?y+g+`
`:y+g,"")}),e.jsx("span",{className:"text-[14px] font-bold",children:((m=t.smallPrice.toString().match(/\d{1,3}(?=(\d{3})*$)/g))==null?void 0:m.join(" "))+" р."}),o?e.jsx(e.Fragment,{}):e.jsx("button",{onClick:()=>p(t._id),className:"rounded-md px-4 shadow-sm hover:shadow-md hover:bg-gray-50 bg-white py-2 border border-black",children:"Изменить"})]})}function V({product:r,close:p,create:a}){let o={name:"",smallPrice:0,bigPrice:0,body:0,fist:0,lips:0,description:"",_id:"",category:"",image:"",gender:"",age:0};const[t,i]=n.useState(r||o),[c,m]=n.useState(null),[y,g]=n.useState(!1),[v,f]=n.useState("");if(n.useEffect(()=>{a&&i(o),!a&&r&&i(r)},[r]),r==null&&!a)return e.jsx(e.Fragment,{});function h(s,u){i(x=>(x[u]=s,x)),g(x=>!x)}async function w(s){s.preventDefault(),a?d():l()}async function l(){let s=new FormData;Object.keys(t).forEach(S=>s.append(S,String(t[S]))),s.append("files",c);let u=await fetch("/api/putPerson",{method:"PUT",body:s}),x=await u.json();if(u.status!==200){f(JSON.stringify(x.message));return}f(x.message)}async function d(){let s=new FormData;Object.keys(t).forEach(S=>s.append(S,String(t[S]))),s.append("files",c);let u=await fetch("/api/postPerson",{method:"POST",body:s}),x=await u.json();if(u.status!==200){f(JSON.stringify(x.message));return}f(x.message)}async function j(){console.log("remove");let s=await fetch("/api/deletePerson",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}),u=await s.json();if(s.status!==200){f(JSON.stringify(u.message));return}f(u.message)}return e.jsx("div",{onClick:()=>{p(null),f(""),m(null)},className:"absolute shadow-2xl bg-black bg-opacity-20 left-0 right-0 top-0 bottom-0 flex justify-center items-center",children:e.jsxs("div",{onClick:s=>s.stopPropagation(),className:"bg-white flex flex-row rounded-3xl p-10 min-w-[900px] gap-12",children:[e.jsx(k,{file:c,edit:!0,data:t,change:p}),e.jsxs("form",{onSubmit:s=>w(s),className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-col max-h-[70vh] p-4 overflow-y-scroll",children:[e.jsx("span",{children:"Имя"}),e.jsx(N,{className:b.editor_input,value:t.name,setter:h,property:"name"}),e.jsx("span",{children:"Описание"}),e.jsx(N,{className:b.editor_input,value:t.description,setter:h,property:"description"}),e.jsx("span",{children:"Цена за час"}),e.jsx(N,{className:b.editor_input,value:t.smallPrice,setter:h,property:"smallPrice",num:!0}),e.jsx("span",{children:"Цена за 8 часов"}),e.jsx(N,{className:b.editor_input,value:t.bigPrice,setter:h,property:"bigPrice",num:!0}),e.jsx("span",{children:"Рот"}),e.jsx(N,{className:b.editor_input,value:t.lips,setter:h,property:"lips",num:!0}),e.jsx("span",{children:"Руки"}),e.jsx(N,{className:b.editor_input,value:t.fist,setter:h,property:"fist",num:!0}),e.jsx("span",{children:"Тело"}),e.jsx(N,{className:b.editor_input,value:t.body,setter:h,property:"body",num:!0}),e.jsx("span",{children:"Пол"}),e.jsxs("select",{onChange:s=>i(u=>(u.gender=s.target.value,u)),className:b.editor_input,children:[e.jsx("option",{value:"man",children:"man"}),e.jsx("option",{value:"woman",children:"woman"}),e.jsx("option",{value:"trans",children:"trans"})]}),e.jsx("span",{children:"Возраст"}),e.jsx(N,{className:b.editor_input,value:t.age,setter:h,property:"age",num:!0}),e.jsx("label",{htmlFor:"photo",className:"px-4 py-2 border-[1px] cursor-pointer hover:bg-gray-200 border-black",children:"Фото"}),e.jsx("input",{id:"photo",className:"mb-[14px]",accept:"image/png, image/jpeg",onChange:s=>m(s.target.files&&s.target.files[0]),type:"file"}),e.jsx("span",{children:"Категория"}),e.jsxs("select",{onChange:s=>i(u=>(u.category=s.target.value,u)),className:b.editor_input,children:[e.jsx("option",{value:t.category,children:t.category}),e.jsx("option",{value:"grand",children:"grand"}),e.jsx("option",{value:"gypsy",children:"gypsy"}),e.jsx("option",{value:"tadj",children:"tadj"})]})]}),v?e.jsx("span",{className:"mx-auto my-3 text-lg underline",children:v}):e.jsx(e.Fragment,{}),e.jsxs("div",{className:"flex flex-row w-fit mx-auto gap-6",children:[e.jsx("button",{className:"px-4 py-2 border-black shadow-sm hover:shadow-md hover:bg-gray-50 border w-fit h-fit mx-auto mt-[14px]",type:"submit",children:a?"Добавить":"Изменить"}),a?e.jsx(e.Fragment,{}):e.jsx("button",{className:"px-4 py-2 border-black shadow-sm hover:shadow-md hover:bg-gray-50 border w-fit h-fit mx-auto mt-[14px]",type:"button",onClick:j,children:"Удалить"})]})]})]})})}function U({setter:r,count:p}){let a={name:"",price:"",priceGT:!1};const[o,t]=n.useState(a);return n.useEffect(()=>{r(o)},[o]),e.jsxs("div",{className:"flex flex-col gap-2 border-t-[1px] border-gray-200 pt-4",children:[e.jsx("span",{children:"Фильтр по названию"}),e.jsx("input",{value:o.name,onChange:i=>t(c=>({...c,name:i.target.value})),className:"border-[1px] pl-2 border-black",type:"text"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("span",{children:"Фильтр по цене"}),e.jsxs("select",{value:Number(o.priceGT),onChange:i=>t(c=>({...c,priceGT:!!Number(i.target.value)})),children:[e.jsx("option",{value:0,children:"Меньше"}),e.jsx("option",{value:1,children:"Больше"})]})]}),e.jsx("input",{value:o.price,onChange:i=>t(c=>({...c,price:i.target.value})),className:"border-[1px] pl-2 border-black",type:"number"}),p?e.jsxs("span",{children:["Найдено по фильтру: ",p]}):e.jsx(e.Fragment,{}),e.jsx("button",{className:"rounded-md px-6 mt-4 w-fit mx-auto shadow-sm hover:shadow-md hover:bg-gray-50 bg-white py-1 border border-black",onClick:()=>t(a),children:"Сброс фильтра"})]})}function N({value:r,property:p,setter:a,num:o=!1,className:t=""}){const[i,c]=n.useState(r);return n.useEffect(()=>{c(r)},[r]),n.useEffect(()=>{a(i,p)},[i]),e.jsx("input",{className:t,value:i,onChange:m=>c(m.target.value),type:o?"number":"text"})}const D="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20id='meteor-icon-kit__regular-products'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%209C9.44771%209%209%209.44771%209%2010V21C9%2021.5523%209.44771%2022%2010%2022H21C21.5523%2022%2022%2021.5523%2022%2021V10C22%209.44771%2021.5523%209%2021%209H10ZM15%207V3C15%202.44772%2014.5523%202%2014%202H3C2.44772%202%202%202.44772%202%203V14C2%2014.5523%202.44772%2015%203%2015H7V10C7%208.34315%208.34315%207%2010%207H15ZM17%207H21C22.6569%207%2024%208.34315%2024%2010V21C24%2022.6569%2022.6569%2024%2021%2024H10C8.34315%2024%207%2022.6569%207%2021V17H3C1.34315%2017%200%2015.6569%200%2014V3C0%201.34315%201.34315%200%203%200H14C15.6569%200%2017%201.34315%2017%203V7Z'%20fill='%23000000'/%3e%3c/g%3e%3c/svg%3e",O="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M10.1992%2012C12.9606%2012%2015.1992%209.76142%2015.1992%207C15.1992%204.23858%2012.9606%202%2010.1992%202C7.43779%202%205.19922%204.23858%205.19922%207C5.19922%209.76142%207.43779%2012%2010.1992%2012Z'%20stroke='%23000000'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1%2022C1.57038%2020.0332%202.74795%2018.2971%204.36438%2017.0399C5.98081%2015.7827%207.95335%2015.0687%2010%2015C14.12%2015%2017.63%2017.91%2019%2022'%20stroke='%23000000'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M17.8205%204.44006C18.5822%204.83059%2019.1986%205.45518%2019.579%206.22205C19.9594%206.98891%2020.0838%207.85753%2019.9338%208.70032C19.7838%209.5431%2019.3674%2010.3155%2018.7458%2010.9041C18.1243%2011.4926%2017.3302%2011.8662%2016.4805%2011.97'%20stroke='%23000000'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M17.3203%2014.5701C18.6543%2014.91%2019.8779%2015.5883%2020.8729%2016.5396C21.868%2017.4908%2022.6007%2018.6827%2023.0003%2020'%20stroke='%23000000'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function G(){const[r,p]=n.useState([]),[a,o]=n.useState(null),[t,i]=n.useState({username:""}),[c,m]=n.useState(null),[y,g]=n.useState(!1);n.useEffect(()=>{v()},[]),n.useEffect(()=>{h(t)},[t]);async function v(){let d=await(await fetch("/api/users")).json();console.log(d),d=d.map(s=>({...s,password:""}));let j=d.map(s=>({...s,favorite:s.favorite.join(",")}));console.log(j),p(j)}function f(l){i(l)}function h(l){let d=r.filter(j=>l.username==""||j.username.includes(l.username));if(r.length==d.length){o(null);return}o(d)}function w(l){if(l===""){g(!0),m("");return}l==null&&(g(!1),m(null),v());let d=r.find(j=>j._id==l);d&&m({...d})}return e.jsxs("div",{className:"flex h-full relative w-full",children:[e.jsx(R,{create:y,product:c,close:w}),e.jsxs("div",{className:"grid grid-cols-4 py-6 mx-auto overflow-y-auto gap-5",children:[!a&&r.map((l,d)=>e.jsx(P,{data:l,change:w},d)),a&&a.map((l,d)=>e.jsx(P,{data:l,change:w},d))]}),e.jsxs("div",{className:"border-l-[1px] ml-auto gap-8 flex w-[28%] flex-col p-4 pt-8 text-lg border-gray-100",children:["Изменить или добавить пользователя.",e.jsx("button",{onClick:()=>w(""),className:"rounded-md px-4 shadow-sm hover:shadow-md hover:bg-gray-50 bg-white py-2 border border-black",children:"Добавить"}),e.jsx(M,{count:a==null?void 0:a.length,setter:f})]})]})}function P({data:r,change:p,file:a,edit:o=!1}){const[t,i]=n.useState(r);return n.useRef(null),n.useEffect(()=>{i(r)},[r]),e.jsxs("div",{className:"flex h-fit border border-gray-200 rounded-lg pb-2 px-2 overflow-hidden flex-col items-center gap-2 leading-4",children:[e.jsx("div",{style:{height:o?"305px":"230px"},className:"w-fit flex items-center overflow-hidden"}),e.jsx("span",{className:"font-bold text-[16px]",children:t.username}),o?e.jsx(e.Fragment,{}):e.jsx("button",{onClick:()=>p(t._id),className:"rounded-md px-4 shadow-sm hover:shadow-md hover:bg-gray-50 bg-white py-2 border border-black",children:"Изменить"})]})}function R({product:r,close:p,create:a}){let o={_id:"",username:"",password:"",privileges:!1,role:"user",gender:"",balance:0,favorite:""};const[t,i]=n.useState(r||o),[c,m]=n.useState(null),[y,g]=n.useState(!1),[v,f]=n.useState("");if(n.useEffect(()=>{a&&i(o),!a&&r&&i(r)},[r]),r==null&&!a)return e.jsx(e.Fragment,{});function h(s,u){i(x=>(x[u]=s,x)),g(x=>!x)}async function w(s){s.preventDefault(),a?d():l()}async function l(){let s={...t};s.favorite=JSON.stringify(s.favorite.split(","));let u=await fetch("/api/putUser",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),x=await u.json();if(u.status!==200){f(JSON.stringify(x.message));return}f(x.message)}async function d(){let s=t;console.log("POST"),s.favorite=JSON.stringify(s.favorite),s.balance=Number(s.balance);let u=await fetch("/api/postUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),x=await u.json();if(u.status!==200){f(JSON.stringify(x.message));return}f(x.message)}async function j(){let s=await fetch("/api/deleteUser",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}),u=await s.json();if(s.status!==200){f(JSON.stringify(u.message));return}f(u.message)}return e.jsxs("div",{className:"absolute shadow-2xl bg-black bg-opacity-20 left-0 right-0 top-0 bottom-0 flex justify-center items-center",children:[e.jsx("div",{onClick:()=>{p(null),f(""),m(null)},className:"absolute top-24 right-24 text-3xl hover:text-red-500 bg-white rounded-full p-4 cursor-pointer select-none",children:"X"}),e.jsxs("div",{onClick:s=>s.stopPropagation(),className:"bg-white flex flex-row min-w-[900px] justify-center rounded-3xl p-10 gap-12",children:[e.jsx(P,{file:c,edit:!0,data:t,change:p}),e.jsxs("form",{onSubmit:s=>w(s),className:"flex min-w-[400px] flex-col",children:[e.jsxs("div",{className:"flex flex-col max-h-[70vh] p-4 overflow-y-scroll",children:[e.jsx("span",{children:"Имя"}),e.jsx(C,{className:b.editor_input,value:t.username,setter:h,property:"username"}),e.jsx("span",{children:"Баланс"}),e.jsx(C,{className:b.editor_input,value:t.balance,setter:h,property:"balance",num:!0}),e.jsx("span",{children:"Пароль"}),e.jsx(C,{className:b.editor_input,value:t.password,setter:h,property:"password"}),e.jsx("span",{children:"Привилегии"}),e.jsx(C,{className:b.editor_input,value:t.privileges,setter:h,property:"privileges",num:!0,bool:!0}),e.jsx("span",{children:"Роль"}),e.jsx(C,{className:b.editor_input,value:t.role,setter:h,property:"role"}),e.jsx("span",{children:"Избраное"}),e.jsx(C,{className:b.editor_input,value:t.favorite,setter:h,property:"favorite"}),e.jsx("span",{children:"Пол"}),e.jsxs("select",{onChange:s=>i(u=>(u.gender=s.target.value,u)),className:b.editor_input,children:[e.jsx("option",{value:"man",children:"man"}),e.jsx("option",{value:"woman",children:"woman"}),e.jsx("option",{value:"trans",children:"trans"})]})]}),v?e.jsx("span",{className:"mx-auto my-3 text-lg underline",children:v}):e.jsx(e.Fragment,{}),e.jsxs("div",{className:"flex flex-row w-fit mx-auto gap-6",children:[e.jsx("button",{className:"px-4 py-2 border-black shadow-sm hover:shadow-md hover:bg-gray-50 border w-fit h-fit mx-auto mt-[14px]",type:"submit",children:a?"Добавить":"Изменить"}),a?e.jsx(e.Fragment,{}):e.jsx("button",{className:"px-4 py-2 border-black shadow-sm hover:shadow-md hover:bg-gray-50 border w-fit h-fit mx-auto mt-[14px]",type:"button",onClick:j,children:"Удалить"})]})]})]})]})}function M({setter:r,count:p}){let a={username:""};const[o,t]=n.useState(a);return n.useEffect(()=>{r(o)},[o]),e.jsxs("div",{className:"flex flex-col gap-2 border-t-[1px] border-gray-200 pt-4",children:[e.jsx("span",{children:"Фильтр по имени"}),e.jsx("input",{value:o.username,onChange:i=>t(c=>({...c,username:i.target.value})),className:"border-[1px] pl-2 border-black",type:"text"}),p?e.jsxs("span",{children:["Найдено по фильтру: ",p]}):e.jsx(e.Fragment,{}),e.jsx("button",{className:"rounded-md px-6 mt-4 w-fit mx-auto shadow-sm hover:shadow-md hover:bg-gray-50 bg-white py-1 border border-black",onClick:()=>t(a),children:"Сброс фильтра"})]})}function C({value:r,property:p,setter:a,num:o=!1,bool:t=!1,className:i=""}){const[c,m]=n.useState(r);n.useEffect(()=>{m(r)},[r]),n.useEffect(()=>{a(c,p)},[c]);function y(g){let v=t&&o?Number(g.target.value)>=1?1:0:g.target.value;m(v)}return e.jsx("input",{className:i,value:typeof c=="boolean"?Number(c):c,onChange:g=>y(g),type:o?"number":"text"})}function B(){const[r,p]=n.useState(0);function a(o){p(o)}return e.jsx("div",{className:"h-full w-full px-4",children:e.jsxs("div",{className:"h-full overflow-hidden flex",children:[e.jsxs("div",{className:"flex flex-col pl-2 py-8 gap-4 text-2xl",children:[e.jsx(_,{choosen:r,svg:D,setter:a,page:0,children:"Каталог"}),e.jsx(_,{choosen:r,svg:O,setter:a,page:1,children:"Пользователи"})]}),e.jsxs("div",{className:"border-l-[1px] border-gray-100 w-full flex",children:[r==0?e.jsx(T,{}):e.jsx(e.Fragment,{}),r==1?e.jsx(G,{}):e.jsx(e.Fragment,{})]})]})})}function _({svg:r,setter:p,page:a,choosen:o,children:t}){return e.jsx("div",{className:"flex mr-2 items-center",children:e.jsxs("div",{style:{background:o==a?"rgb(243 244 246)":""},onClick:()=>p(a),className:"flex w-full items-center select-none cursor-pointer shadow-md hover:shadow-lg hover:bg-gray-50 flex-row px-4 py-2 gap-3 text-xl border-[1px] border-gray-100 rounded-lg",children:[e.jsx("span",{className:"h-fit",style:{textDecoration:o===a?"underline1":""},children:t}),e.jsx("img",{className:"max-w-[35px] aspect-square",src:r,alt:"0"})]})})}function J(){return e.jsx(B,{})}const H=E(document.getElementById("root"));H.render(e.jsx(J,{}));
